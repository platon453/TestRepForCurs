# Event loop
## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Event Loop

### –ß—Ç–æ —Ç–∞–∫–æ–µ callBack
- –ö–æ–ª–±—ç–∫–∏ ‚Äî —ç—Ç–æ –∞—Ä–≥—É–º–µ–Ω—Ç/–ø–∞—Ä–∞–º–µ—Ç—Ä-—Ñ—É–Ω–∫—Ü–∏–∏.
- –§—É–Ω–∫—Ü–∏—è() –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞. –ê–Ω–∞–ª–æ–≥–∏—è - –≤–æ—Ç –º–æ–π –Ω–æ–º–µ—Ä, –ø–µ—Ä–µ–∑–≤–æ–Ω–∏, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–æ!
- –ö–æ–ª–±—ç–∫ ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç –≤ –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ –ø–æ–∑–∂–µ (–ª–∏–±–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –ª–∏–±–æ –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è).
    - –ü—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    ```js
    console.log("1. –ù–∞—á–∞–ª–æ");
    setTimeout(() => {
    console.log("2. –Ø –ø—Ä–æ—Å–Ω—É–ª—Å—è!");
    }, 2000);
    console.log("3. –ö–æ–Ω–µ—Ü"); 
    //–ü–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞ 1, 3, 2
    ```
## –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –¥–æ–≤–æ–ª—å–Ω–æ –ø–ª–æ—Ö –∏ –≤–æ—Ç –ø–æ—á–µ–º—É:
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–¥ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ "–ø–∏—Ä–∞–º–∏–¥—É —Å–º–µ—Ä—Ç–∏"
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫: –í –∫–æ–ª–±—ç–∫–∞—Ö –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ—à–∏–±–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é, —á—Ç–æ —á–∞—Å—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–æ–ø—É—Å–∫—É –±–∞–≥–æ–≤.
- –ü—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–≥–æ –∞–¥–∞:
```js
const publishPost = (postId) => {
    console.log("üöÄ –ù–∞—á–∏–Ω–∞–µ–º –ø—É–±–ª–∏–∫–∞—Ü–∏—é..."); //1

    // –ö–æ–ª–±—ç–∫ ‚Ññ1: –ò—â–µ–º –ø–æ—Å—Ç –≤ –±–∞–∑–µ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
    db.findPost(postId, (post) => {
        console.log("‚úÖ –ü–æ—Å—Ç –Ω–∞–π–¥–µ–Ω"); //—ç—Ç–æ –≤—ã–∑–æ–≤–∏—Ç—å—Å—è –∫–æ–≥–¥–∞ –ø–æ—Å—Ç –Ω–∞–π–¥–µ—Ç—Å—è //3

        // –ö–æ–ª–±—ç–∫ ‚Ññ2: –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
        auth.checkPermissions(post.authorId, (hasAccess) => {
            if (hasAccess) {
                console.log("‚úÖ –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω"); //4

                // –ö–æ–ª–±—ç–∫ ‚Ññ3: –°–∂–∏–º–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
                image.compress(post.image, (compressedImg) => {
                    console.log("‚úÖ –ö–∞—Ä—Ç–∏–Ω–∫–∞ —Å–∂–∞—Ç–∞"); //5

                    // –ö–æ–ª–±—ç–∫ ‚Ññ4: –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
                    api.upload(compressedImg, (url) => {
                        console.log("‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:", url); //6

                        // –ö–æ–ª–±—ç–∫ ‚Ññ5: –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ –±–∞–∑–µ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
                        db.updateStatus(postId, "published", () => {
                            console.log("üéâ –ü–æ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!"); //7
                        });
                    });
                });
            }
        });
    });
    
    console.log("‚è≥ –ö–æ–¥ –ø–æ—à–µ–ª –¥–∞–ª—å—à–µ, –ø–æ–∫–∞ –º—ã –∂–¥–µ–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö..."); //2
};

console.log(publishPost());
```
- –†–∞–∑–±–µ—Ä–µ–º –ø—Ä–∏–º–µ—Ä:
    - //1, //2 —ç—Ç–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å.
- –ü–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:
    1. –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É (//1 –∏ //2)
    2. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (db.findPost, auth.checkPermissions –∏ —Ç.–¥.) –ø–æ–º–µ—â–∞—é—Ç —Å–≤–æ–∏ –∫–æ–ª–±—ç–∫–∏ –≤ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (Task Queue)
    3. JavaScript —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–µ—Å—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥, –ø–æ—Ç–æ–º –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:
    - –ö–æ–≥–¥–∞ —Ç—ã –≤—ã–∑—ã–≤–∞–µ—à—å db.findPost(postId, callback), —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.
- –û–Ω–∞:
    1. –ó–∞–ø—É—Å–∫–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
    2. –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ø–æ—ç—Ç–æ–º—É //2 –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É)
    3. –ü–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è, –≤—ã–∑—ã–≤–∞–µ—Ç –∫–æ–ª–±—ç–∫
## –ò–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏, –ø–æ–∫–∞ –∂–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö). –ù–æ –≤—Å–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞–º–Ω–æ–≥–æ –ø—Ä–æ—â–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ **Promise**
## –¢–∞–∫-–∂–µ –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å:
### –ß—Ç–æ —Ç–∞–∫–æ–µ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞ –∏ —á—Ç–æ —Ç–∞–∫–æ–µ –º–∞–∫—Ä–æ–∑–∞–¥–∞—á–∞
- –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏: (Microtasks / Microtask Queue)- —ç—Ç–æ –∑–∞–¥–∞—á–∏ —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–æ–≤ –∏ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –º–∞–∫—Ä–æ–∑–∞–¥–∞—á–µ–π. 
    - —Ç–∞–∫–∏–µ –∫–∞–∫: then(), catch(), finally(), async/await
- –ú–∞–∫—Ä–æ–∑–∞–¥–∞—á–∏: (Macrotasks / Task Queue) - —ç—Ç–æ –±–æ–ª–µ–µ "—Ç—è–∂–µ–ª—ã–µ", –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á (Task Queue). 
    - —Ç–∞–∫–∏–µ –∫–∞–∫: fetch –∑–∞–ø—Ä–æ—Å—ã, setTimeout, setInterval

–ü—Ä–º–µ—Ä –∫–æ–¥–∞ –º–∞–∫—Ä–æ –∏ –º–∏–∫—Ä–æ –∑–∞–¥–∞—á
```js
console.log('1'); // 1Ô∏è‚É£ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
setTimeout(() => { // –ú–∞–∫—Ä–æ–∑–∞–¥–∞—á–∞
    console.log('2'); // 4Ô∏è‚É£
    Promise.resolve().then(() => console.log('3')); // 5Ô∏è‚É£ –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞ –≤–Ω—É—Ç—Ä–∏ –º–∞–∫—Ä–æ–∑–∞–¥–∞—á–∏
}, 0);
Promise.resolve().then(() => { // –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞
    console.log('4'); // 3Ô∏è‚É£
    setTimeout(() => console.log('5'), 0); // 6Ô∏è‚É£ –ú–∞–∫—Ä–æ–∑–∞–¥–∞—á–∞ –≤–Ω—É—Ç—Ä–∏ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏
});
console.log('6'); // 2Ô∏è‚É£ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
```
- –ï—â–µ –æ–¥–∏–Ω –ø—Ä–∏–º–µ—Ä:
```
console.log('Start'); //1

// –ú–∞–∫—Ä–æ–∑–∞–¥–∞—á–∞
setTimeout(() => console.log('Timeout'), 0); //4

// –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞
Promise.resolve().then(() => console.log('Promise')); //3

// –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
console.log('End'); //2
```
### Event Loop ‚Äî –∫–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- Call Stack (—Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤) ‚Äî –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥
- Web APIs (–≤ –±—Ä–∞—É–∑–µ—Ä–µ) / C++ APIs (–≤ Node.js) ‚Äî –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (setTimeout, AJAX, —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤)
- Callback Queue/Task Queue ‚Äî –æ—á–µ—Ä–µ–¥—å –∫–æ–ª–±—ç–∫–æ–≤, –≥–æ—Ç–æ–≤—ã—Ö –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
- Microtask Queue ‚Äî –æ—á–µ—Ä–µ–¥—å –¥–ª—è –ø—Ä–æ–º–∏—Å–æ–≤ (Promise.then/catch/finally)
- Event Loop ‚Äî –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–µ–∫ –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏–∑ –æ—á–µ—Ä–µ–¥–µ–π
---
## –ò —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å —ç—Ç—É –Ω–µ–ø–æ–Ω—è–Ω—É—é, –Ω–µ—á–µ—Ç–∞–±–ª–∏–Ω—É—é –ø–∏—Ä–∞–º–∏–¥—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã Nodejs –ø—Ä–∏–¥—É–º–∞–ª–∏ promise(–æ–±–µ—â–∞–Ω–∏–µ)
–£ –ø—Ä–æ–º–∏—Å–∞ –µ—Å—Ç—å 2 —Å–æ—Å—Ç–æ—è–Ω–∏—è —ç—Ç–æ:
- Resolved(–£—Å–ø–µ—Ö)
- Rejected(–û—à–∏–±–∫–∞)
–ü—Ä–∏–º–µ—Ä –∏–∑ –∂–∏–∑–Ω–∏:
- –í—ã —Å–∏–¥–∏—Ç–µ –∑–∞ —Å—Ç–æ–ª–∏–∫–æ–º, –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∞–ª—å—à–µ:
    - Resolved(–£—Å–ø–µ—Ö) - –ø–µ–π–¥–∂–µ—Ä –∑–∞–ø–∏—â–∞–ª, –ï–¥–∞ –≥–æ—Ç–æ–≤–∞
    - Rejected(–û—à–∏–±–∫–∞) - –ø–æ–≤–∞—Ä —Å–∫–∞–∑–∞–ª, —á—Ç–æ –∫–æ—Ç–ª–µ—Ç—ã –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å




